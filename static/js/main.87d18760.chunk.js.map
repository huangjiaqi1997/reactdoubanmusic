{"version":3,"sources":["reducer/user.js","reducer/song.js","container/Headbar/login.js","container/Collection/index.jsx","container/SearchResult/index.jsx","container/Headbar/index.js","container/Playlist/index.js","script/script.js","container/CommentList/index.jsx","container/Playmain/index.js","container/Spectrum/index.js","container/Controllerbar/index.js","App.js","reducer/index.js","store.js","index.js"],"names":["userInitialState","userID","error","theme","authSuccess","payload","Object","objectSpread","type","code","userReducer","state","arguments","length","undefined","action","num","initialState","isPlaying","currentSong","playlistID","collectionID","playlist","collection","searchResult","singles","albums","commentList","hotComments","comments","isLoading","message","toCurrentSongPlay","song","console","log","dispatch","requestInitiate","axios","get","concat","id","then","res","status","data","lrc","lyrics","lyric","getLrcSuccess","toggleCollect","isisCollected","toggleCollectSuccess","addToPlaylist","string","getState","albumImgURL","songs","al","picUrl","addToPlaylistSuccess","msg","getMyPlaAndColSuccess","removeSuccess","getSingleSearchResultSuccess","getAlbumSearchResultSuccess","getCommentListSuccess","sendCommentSuccess","text","playReducer","map","item","i","isCollected","inPlaylist","filter","playList","some","forEach","toConsumableArray","list","Login","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","email","password","saveCookie","container","document","querySelector","closeHandle","bind","assertThisInitialized","loginHandle","toRegister","onClose","changeDialog","_this$state","telEml","pwd","onLogin","_this2","actions","react_default","a","createElement","FlatButton_default","label","primary","keyboardFocused","onClick","className","Dialog_default","title","modal","open","onRequestClose","handleClose","TextField_default","onChange","e","setState","target","value","hintText","floatingLabelText","Component","Collection","body","appendChild","handleToggleCollect","handleAddToPlay","handleAddToPlaylist","removeChild","ReactDOM","createPortal","List","style","width","margin","paddingTop","Subheader_default","display","IconButton_default","verticalAlign","playlist_play_default","padding","float","clear_default","Divider_default","overflowY","height","key","primaryText","name","artist","leftIcon","star_default","rightIcon","play_arrow_default","position","left","top","add_default","connect","SearchResult","tab","getAlbumsDone","handleTabChange","handleCollected","getSingleSearchResult","keyword","getAlbumSearchResult","rightIconMenu","IconMenu_default","iconButtonElement","more_vert_default","MenuItem_default","content","CircularProgress_default","size","thickness","secondaryText","albumName","star_border_default","contained","containedSong","artistName","leftAvatar","Avatar_default","src","coverURL","rightIconButton","overflow","Tabs","result","push","artists","album","blurPicUrl","count","songCount","bool","styles","button","lineHeight","Headbar","showLoginModal","showSearchButton","showSearchModal","showCollectionModal","searchText","getMyPlaAndColDone","child_loginHandle","child_registerHandle","logoutHandle","getUserID","getMyPlaAndCol","login","register","logout","removePlaAndColAll","icon","search_default","fontSize","paddingBottom","marginLeft","onBlur","onKeyDown","keyCode","handleChangeTheme","color_lens_default","openMenu","onRequestChange","handleOnRequestChange","changeTheme","backgroundColor","sheet","styleSheets","cssRules","rules","deleteRule","deteleRules","onChangeTheme","labelStyle","Headbar_login","onRegister","isLoginModal","container_Collection","container_SearchResult","user","Cookies","URL","set","account","post","remove","tracks","track","ar","Playlist","itemClickHandle","handleRemoveAll","handleCollectButton","handleRemoveButton","removePlaylistAll","stopPropagation","collected","Toggle_default","handleRemoveAllChange","star","launch_default","getThemeColor","image","Image","crossOrigin","Promise","resolve","reject","onload","themeColor","resultArr","arrContainerSort","len","hsum","ssum","lsum","subArr","j","parseFloat","h","s","l","toFixed","get_result_arr","arrContainer","sort","b","get_hslobj_arr_container_sort","hslArrSort","flag","nextItem","Math","abs","arr","get_hslobj_arr_container","hslArr","numA","Number","replace","numB","get_hslobj_arr_sort","imgDataArr","rgbArr","r","g","rgb","hsl","rgbToHsl","get_hslobj_arr","context","getContext","drawImage","getImageData","get_imagedata_rgb_arr","firstColor","firstNumH","firstNumL","secondColor","maxFor","numH","numL","condition","get_second_color","secondNumH","thirdColor","condition1","condition2","get_third_color","to","obj","keys","color1","color2","color3","init","max","min","d","getDate","time","date","Date","getFullYear","getMonth","CommentList","commentText","handleSendComment","getCommentList","currentId","sendComment","hotCommentList","subtitle","Card","commentID","userName","avatar","userAvatarURL","multiLine","rows","rowsMax","songID","commentData","hotCommentData","userId","nickname","avatarUrl","commentId","liked","likeCount","likedCount","Playmain","isShowCommitListModal","lrcWrapper","audio","lrcArr","split","lrcObjArr","t","substring","indexOf","parseInt","c","isNaN","ulE","li","innerText","dataset","timeline","innerHTML","addEventListener","currentTime","lines","querySelectorAll","_thisHeight","nextLine","line","clientHeight","interval","k","setTimeout","marginTop","colors","rule1","rule2","rule3","rule4","rule5","insertRule","textAlign","minWidth","alt","titleStyle","container_CommentList","currentSongID","Spectrum","AudioSpectrum_default","audioId","capColor","capHeight","meterWidth","meterCount","meterColor","stop","color","gap","secondToMinute","floor","sec","round","getRandomIndex","prevI","random","Controllerbar","volume","playModel","duration","togglePlayPauseHandle","playNextHandle","playPreviousHandle","modelChangeHandle","timeSliderChangeHandle","volSliderChangeHandle","audioElement","refs","changeTimeSlider","changeVolSlider","onloadeddata","onplaying","setInterval","onended","pause","play","toggleIsPlaying","newCurrentSong","load","newIndex","sliderValue","newCurrentTime","newVol","_this3","timeSliderDisabled","timeSliderValue","volSliderValue","playModelButton","loop_default","replay_default","swap_horiz_default","playOrPauseButton","pause_default","Slider_default","disabled","ref","onDragStop","volume_up_default","fast_rewind_default","fast_forward_default","autoPlay","App","darkBaseTheme","lightBaseTheme","MuiThemeProvider_default","muiTheme","getMuiTheme","container_Headbar","changeMuiTheme","container_Playlist","container_Playmain","container_Controllerbar","container_Spectrum","combineReducers","win","window","storeEnhancers","compose","applyMiddleware","apply","devToolsExtension","f","createStore","reducer","render","es","store","src_App","getElementById"],"mappings":"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","file":"static/js/main.87d18760.chunk.js","sourcesContent":["import axios from 'axios';\r\nimport Cookies from 'js-cookie';\r\n\r\n// user\r\nconst userInitialState = {\r\n  userID: '',\r\n  error: '',\r\n  theme: 0\r\n}\r\n\r\nconst USER_GET_USERID = 'USER_GET_USERID'\r\nconst USER_AUTH_SUCCESS = 'USER_AUTH_SUCCESS' // reducer操作相同\r\nconst USER_LOGOUT_SUCCESS = 'USER_LOGOUT_SUCCESS'\r\nconst USER_ERR = 'USER_ERR'\r\nconst USER_CHANGE_THEME = 'USER_CHANGE_THEME'\r\n\r\n// actionID\r\nconst authSuccess = (payload) => ({\r\n  type: USER_AUTH_SUCCESS, ...payload\r\n})\r\nexport const logout = () => {\r\n  Cookies.remove('userID')\r\n  return {type: USER_LOGOUT_SUCCESS}\r\n}\r\n\r\nconst error = (code) => ({\r\n  code, type: USER_ERR, \r\n})\r\n\r\n\r\nexport const getUserID = () => {\r\n  return {type: USER_GET_USERID, userID:Cookies.get('userID')}\r\n}\r\nexport const changeTheme = (num) => {\r\n  return {num, type: USER_CHANGE_THEME}\r\n}\r\n\r\nexport const login = (data) => {\r\n  // const {email, password} = data;\r\n  const URL = `/login?email=${'13702056736@163.com'}&password=${'a19970715'}`\r\n  return dispatch => {\r\n    axios.get(URL)\r\n      .then(res => {\r\n        if (res.data.code === 200) {\r\n          Cookies.set('userID', res.data.account.id)\r\n          dispatch(authSuccess({userID: res.data.account.id}));\r\n        } else {\r\n          dispatch(error(res.data.code));\r\n        }\r\n      })\r\n  }\r\n}\r\n// export const logout = () => {\r\n\r\n  // /logout接口 调用失败\r\n  // return dispatch => {\r\n  //   axios.get('/logout')\r\n  //     .then(res => {\r\n  //       if (res.data.code === 200) {\r\n  //         Cookies.remove('userID')\r\n  //         dispatch(logoutSuccess());\r\n  //       } else {\r\n  //         dispatch(error(res.data.code));\r\n  //       }\r\n  //     })\r\n  // }\r\n// }\r\n\r\nexport const register = (data) => {\r\n  return dispatch => {\r\n    axios.post('/register', data)\r\n      .then(res => {\r\n        if (res.status === 200 && res.data.code === 0) {\r\n          dispatch(authSuccess(res.data.data));\r\n        } else {\r\n          dispatch(error(res.data.msg));\r\n        }\r\n      })\r\n  }\r\n}\r\n\r\nconst userReducer = (state=userInitialState, action) => {\r\n  switch (action.type) {\r\n    case USER_GET_USERID:\r\n      return {\r\n        ...state,\r\n        userID: action.userID\r\n      }\r\n    case USER_AUTH_SUCCESS:\r\n      return {\r\n        ...state,\r\n        userID: action.userID,\r\n      }\r\n    case USER_LOGOUT_SUCCESS:\r\n      return {\r\n        ...state,\r\n        userID: ''\r\n      }\r\n    case USER_ERR:\r\n      return {\r\n        ...state,\r\n        error: action.code\r\n      }\r\n    case USER_CHANGE_THEME:\r\n      return {\r\n        ...state,\r\n        theme: action.num\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default userReducer;\r\n","import axios from 'axios';\r\n\r\nconst initialState = {\r\n  isPlaying: false,\r\n  currentSong: {},\r\n  playlistID: '',\r\n  collectionID: '',\r\n  playlist: [\r\n    // {ID、名称、歌手、类型、imgUrl}\r\n  ],\r\n  collection: [],\r\n  searchResult: {\r\n    singles: '', \r\n    albums: ''\r\n  },\r\n  commentList: {\r\n    hotComments:[],\r\n    comments: []\r\n  },\r\n  isLoading: false,\r\n  message: ''\r\n}\r\n// 获取播放列表、收藏列表，及其ID\r\nconst SONG_GET_PLA_AND_COL_SUCCESS = 'SONG_GET_PLA_AND_COL_SUCCESS'\r\n// 获取歌词 => store[currentSong] （播放）\r\nconst SONG_GET_LRC_SUCCESS = 'SONG_GET_LRC_SUCCESS'\r\n// playlist 移除一首歌曲\r\nconst SONG_REMOVE_SUCCESS = 'SONG_REMOVE_SUCCESS'\r\nconst SONG_REMOVE_PLALIST_ALL = 'SONG_REMOVE_PLALIST_ALL'\r\nconst SONG_REMOVE_PLA_COL_ALL = 'SONG_REMOVE_PLA_COL_ALL'// 登出 \r\n// 切换收藏\r\nconst SONG_TOGGLE_COLLECT = 'SONG_TOGGLE_COLLECT'\r\n// 切换 isPlaying\r\nconst SONG_TOGGLE_ISPLAYING = 'SONG_TOGGLE_ISPLAYING'\r\n\r\n\r\nconst SONG_PLAY_COL_ALL = 'SONG_PLAY_COL_ALL'\r\nconst SONG_GET_SINGLE_SEARCH_RESULT_SUCCESS = 'SONG_GET_SINGLE_SEARCH_RESULT_SUCCESS'\r\nconst SONG_GET_ALBUM_SEARCH_RESULT_SUCCESS = 'SONG_GET_ALBUM_SEARCH_RESULT_SUCCESS'\r\nconst SONG_GET_COMMENT_LIST_SUCCESS = 'SONG_GET_COMMENT_LIST_SUCCESS'\r\nconst SONG_ADD_TO_PLAYLIST_SUCCESS = 'SONG_ADD_TO_PLAYLIST_SUCCESS'\r\nconst SONG_SEND_COMMENT_SUCCESS = 'SONG_SEND_COMMENT_SUCCESS'\r\n\r\n\r\nconst SONG_REQUEST_INITIATE = 'SONG_REQUEST_INITIATE'\r\nconst SONG_MESSAGE = 'SONG_MESSAGE'\r\n\r\n\r\nexport const toggleIsPlaying = () => ({type: SONG_TOGGLE_ISPLAYING});\r\nexport const playColAll = (songID) => ({type: SONG_PLAY_COL_ALL})\r\nexport const removePlaAndColAll = () => ({type: SONG_REMOVE_PLA_COL_ALL})\r\n\r\n\r\n// 获取播放列表、收藏列表，及其ID\r\nexport const getMyPlaAndCol = (userID) => {\r\n  return dispatch => {\r\n    dispatch(requestInitiate())\r\n\r\n    // 获取用户歌单\r\n    axios.get(`/user/playlist?uid=${userID}`)\r\n      .then(res => {\r\n        if (res.data.code === 200) {\r\n          const playlistID = res.data.playlist[1].id;\r\n          const collectionID = res.data.playlist[0].id;\r\n          const playlist = [];\r\n          const collection = [];\r\n          let currentSong = {};\r\n          // 成功后获取歌单详情\r\n          axios.get(`/playlist/detail?id=${playlistID}`)\r\n            .then(res => {\r\n              if(res.data.code === 200) {\r\n                const tracks = res.data.playlist.tracks;\r\n                for (let i = 0; i < tracks.length; i++) {\r\n                  const track = tracks[i]\r\n                  playlist.push({\r\n                    name: track.name,\r\n                    id: track.id,\r\n                    artist: track.ar[0].name,\r\n                    albumName: track.al.name,\r\n                    albumImgURL: track.al.picUrl\r\n                  })\r\n                }\r\n                // 获取歌词\r\n                playlist[0] &&\r\n                axios.get(`/lyric?id=${playlist[0].id}`)\r\n                .then(res => {\r\n                  if(res.status ===200 && res.data.code === 200) {\r\n                    const lrc = res.data.lrc;\r\n                    const lyrics = lrc ? lrc.lyric : ''\r\n                    currentSong = {lyrics, ...playlist[0]}\r\n\r\n                    axios.get(`/playlist/detail?id=${collectionID}`)\r\n                .then(res => {\r\n                  if(res.data.code === 200) {\r\n                    const tracks = res.data.playlist.tracks;\r\n                    for (let i = 0; i < tracks.length; i++) {\r\n                      const track = tracks[i]\r\n                      collection.push({\r\n                        name: track.name,\r\n                        id: track.id,\r\n                        artist: track.ar[0].name,\r\n                        albumName: track.al.name,\r\n                        albumImgURL: track.al.picUrl,\r\n                        isCollected: true\r\n                      })\r\n                    }\r\n                    dispatch(getMyPlaAndColSuccess({playlistID,collectionID, playlist, collection, currentSong}))\r\n\r\n                  } else {}\r\n\r\n                })\r\n                  } else {}\r\n                })\r\n              } else {}\r\n\r\n              \r\n            })\r\n          \r\n        } else {}\r\n      })\r\n  }\r\n}\r\n// 获取歌词 => store[currentSong] （播放）\r\nexport const toCurrentSongPlay = (song) => {\r\n  console.log(song);\r\n  return dispatch => {\r\n    dispatch(requestInitiate())\r\n    axios.get(`/lyric?id=${song.id}`)\r\n      .then(res => {\r\n        if(res.status ===200 && res.data.code === 200) {\r\n          const lrc = res.data.lrc;\r\n          const lyrics = lrc ? lrc.lyric : ''\r\n          dispatch(getLrcSuccess({lyrics, ...song}))\r\n        } else {}\r\n      })\r\n  }\r\n}\r\nexport const remove = (song) => {\r\n  return (dispatch, getState) => {\r\n    dispatch(requestInitiate())\r\n    axios.get(`/playlist/tracks?op=del&pid=${getState().song.playlistID}&tracks=${song.id}`)\r\n      .then(res => {\r\n        if (res.status === 200 && res.data.code === 200) {\r\n          console.log('remove success!');\r\n          dispatch(removeSuccess(song))  \r\n        } else {}\r\n      })\r\n  }\r\n}\r\nexport const removePlaylistAll = () => {}\r\nexport const toggleCollect = (song, isisCollected) => {\r\n  return dispatch => {\r\n    dispatch(requestInitiate())\r\n    axios.get(`/like?id=${song.id}&like=${!isisCollected}`)\r\n      .then(res => {\r\n        if (res.status === 200 && res.data.code === 200) {\r\n          dispatch(toggleCollectSuccess(song, isisCollected))  \r\n        } else {}\r\n      })\r\n  }\r\n}\r\n\r\n// collection、搜索结果中 添加到 playlist\r\nexport const addToPlaylist = (song, string) => {\r\n  return (dispatch, getState) => {\r\n    dispatch(requestInitiate())\r\n    axios.get(`/playlist/tracks?op=add&pid=${getState().song.playlistID}&tracks=${song.id}`)\r\n      .then(res => {\r\n        if (res.status === 200 && res.data.code === 200) {\r\n\r\n          if (!string) {\r\n            dispatch(addToPlaylistSuccess(song))  \r\n          } else {\r\n            axios.get(`http://musicapi.leanapp.cn/song/detail?ids=${song.id}`)\r\n              .then(res=> {\r\n                if (res.status === 200 && res.data.code === 200) {\r\n                  const albumImgURL = res.data.songs[0].al.picUrl;                  \r\n                  dispatch(addToPlaylistSuccess({albumImgURL, ...song}))\r\n                  dispatch(toCurrentSongPlay({albumImgURL, ...song})) \r\n                }\r\n              })\r\n          }\r\n          \r\n        } else {\r\n          dispatch(message({msg: res.data.msg}))\r\n        }\r\n      })\r\n    }\r\n} \r\n// 获取 搜索的结果（单曲/专辑）\r\nexport const getSingleSearchResult = (keyword) => {\r\n  return dispatch => { \r\n    dispatch(requestInitiate())\r\n    axios.get(`/search?keywords=${keyword}&limit=50`)// &limit 默认30\r\n      .then(res => {\r\n        if(res.status === 200 && res.data.code === 200) {\r\n          // 无结果时，服务器返回：\r\n          // {\r\n          //   result: {\r\n          //   songCount: 0\r\n          //   },\r\n          //   code: 200\r\n          // }\r\n          const singles = res.data.result.songs || []\r\n          const data = [];\r\n          for(let i = 0; i < singles.length; i++) {\r\n            const item = singles[i]\r\n            data.push({\r\n              id: item.id,\r\n              name: item.name,\r\n              artist: item.artists[0].name,\r\n              albumName: item.album.name,\r\n            })\r\n          }        \r\n          dispatch(getSingleSearchResultSuccess(data))\r\n        } else {}\r\n      })\r\n  }\r\n}\r\nexport const getAlbumSearchResult = (keyword) => {\r\n  return dispatch => {\r\n    dispatch(requestInitiate())\r\n    axios.get(`/search?keywords=${keyword}&type=10`)\r\n      .then(res => {\r\n        if(res.status === 200 && res.data.code === 200) {\r\n          // 无结果时，返回 { code: 200 }\r\n          // result 为 undefined\r\n          const albums = res.data.result\r\n          ? res.data.result.albums\r\n          : [];\r\n          const data = [];\r\n          for(let i = 0; i < albums.length; i++) {\r\n            const item = albums[i]\r\n            data.push({\r\n              id: item.id,\r\n              name: item.name,\r\n              artistName: item.artists[0].name,\r\n              coverURL: item.blurPicUrl,\r\n              containedSong: item.containedSong,\r\n              count: item.songCount\r\n            })\r\n          }\r\n          dispatch(getAlbumSearchResultSuccess(data))\r\n        } else {}\r\n      })\r\n  }\r\n}\r\n// 获取评论（默认20条）hotComment、comment两组\r\nexport const getCommentList = (songID) => {\r\n  return dispatch => {\r\n    dispatch(requestInitiate())\r\n    axios.get(`/comment/music?id=${songID}&limit=30`)\r\n      .then(res => {\r\n        if(res.status === 200 && res.data.code === 200) {\r\n          const commentData = res.data.comments || [];\r\n          const hotCommentData = res.data.hotComments || [];\r\n          const comments = [];\r\n          const hotComments = [];\r\n          for(let i = 0; i < commentData.length; i++) {\r\n            const item = commentData[i]\r\n            comments.push({\r\n              userID: item.user.userId,\r\n              userName: item.user.nickname,\r\n              userAvatarURL: item.user.avatarUrl,\r\n              commentID: item.commentId,\r\n              content: item.content,\r\n              liked: item.liked,\r\n              likeCount: item.likedCount,\r\n              time: item.time\r\n            })\r\n          }\r\n          for(let i = 0; i < hotCommentData.length; i++) {\r\n            const item = hotCommentData[i]\r\n            hotComments.push({\r\n              userID: item.user.userId,\r\n              userName: item.user.nickname,\r\n              userAvatarURL: item.user.avatarUrl,\r\n              commentID: item.commentId,\r\n              content: item.content,\r\n              liked: item.liked,\r\n              likeCount: item.likedCount,\r\n              time: item.time\r\n            })\r\n          }          \r\n          dispatch(getCommentListSuccess({hotComments, comments}))\r\n        } else {}\r\n      })\r\n  }\r\n}\r\n\r\n\r\nexport const sendComment = (text, id) => {\r\n  return dispatch => {\r\n    dispatch(requestInitiate())\r\n    axios.get(`/comment?t=1&type=0&id=${id}&content=${text}`)\r\n      .then(res => {\r\n        if (res.status === 200 && res.data.code === 200) {\r\n          dispatch(sendCommentSuccess(text))\r\n        }\r\n      })\r\n  }\r\n}\r\n\r\n\r\n\r\nconst getMyPlaAndColSuccess = (payload) => ({type: SONG_GET_PLA_AND_COL_SUCCESS, ...payload})\r\nconst getLrcSuccess = (payload) => ({type: SONG_GET_LRC_SUCCESS, currentSong: payload})\r\nconst addToPlaylistSuccess = (song) =>({song,  type: SONG_ADD_TO_PLAYLIST_SUCCESS})\r\n\r\n\r\nconst removeSuccess = (song) => ({song, type: SONG_REMOVE_SUCCESS})\r\nconst removePlaylistAllSuccess = () =>({type: SONG_REMOVE_PLALIST_ALL})\r\nconst toggleCollectSuccess = (song, isisCollected) =>({song, isisCollected, type: SONG_TOGGLE_COLLECT})\r\nconst getSingleSearchResultSuccess = (payload) => ({\r\n  type: SONG_GET_SINGLE_SEARCH_RESULT_SUCCESS, singles: payload\r\n})\r\nconst getAlbumSearchResultSuccess = (payload) => ({\r\n  type: SONG_GET_ALBUM_SEARCH_RESULT_SUCCESS, albums: payload\r\n})\r\nconst getCommentListSuccess = (payload) => ({\r\n  type: SONG_GET_COMMENT_LIST_SUCCESS, comments: payload.comments, hotComments: payload.hotComments\r\n})\r\nconst sendCommentSuccess = (text) => ({text, type: SONG_SEND_COMMENT_SUCCESS})\r\nconst message = (payload) => ({type: SONG_MESSAGE, msg: payload.msg})\r\nconst requestInitiate = () =>({type: SONG_REQUEST_INITIATE})\r\n\r\nconst playReducer = (state=initialState, action) => {\r\n  console.log(action);\r\n  let collection;\r\n  let playlist;\r\n  switch (action.type) {\r\n    // 得到 playlist、collection\r\n    // 对比计算歌曲的  isCollected、 inPlaylist 属性\r\n    // 设置 currentSong (载入网站后直接播放playlist[0])\r\n    case SONG_GET_PLA_AND_COL_SUCCESS:\r\n      // collection 的 isCollected 都标为 true\r\n      // 遍历 playlist，其中若也有 collection 中的歌曲：\r\n      // 将 playlist[i].isCollected 标为 true\r\n      // 将 collection[i].inPlaylist 标为 true\r\n      playlist = action.playlist.map((item) => {\r\n        for (let i = 0; i<action.collection.length; i++) {\r\n          if (item.id === action.collection[i].id) {\r\n            item.isCollected = true\r\n            action.collection[i].inPlaylist = true\r\n          } \r\n        }\r\n        return item\r\n      })\r\n      return {\r\n        ...state,\r\n        playlist: playlist,\r\n        collection: action.collection,\r\n        playlistID: action.playlistID,\r\n        collectionID: action.collectionID,\r\n        currentSong: action.currentSong,\r\n        isLoading: false\r\n      }\r\n    // 获得 lrc，并将 设置 song 为 currentSong\r\n    // isPlaying => true\r\n    case SONG_GET_LRC_SUCCESS:\r\n      return {\r\n        ...state,\r\n        currentSong: action.currentSong,\r\n        isPlaying: true,\r\n        isLoading: false\r\n      }\r\n    case SONG_REMOVE_SUCCESS:\r\n      playlist = state.playlist.filter(i => i.id !== action.song.id);\r\n      console.log(action.song.isisCollected);\r\n      collection = action.song.isisCollected\r\n        ? state.collection.map(i=> {\r\n          \r\n          \r\n          i.id===action.song.id && (i.inPlaylist = false)\r\n          return i\r\n        })\r\n        : state.collection\r\n      return {\r\n        ...state,\r\n        playlist: playlist,\r\n        collection: collection,\r\n        isLoading: false\r\n      }\r\n    case SONG_REMOVE_PLALIST_ALL:\r\n      return {\r\n        ...state,\r\n        playList: [],\r\n        isLoading: false\r\n      }\r\n    case SONG_TOGGLE_COLLECT:          \r\n      // 更改collection\r\n      let msg = '';\r\n      let isisCollected = action.isisCollected\r\n\r\n      // 来自搜索结果的 只管添加\r\n      // 滤除 来自搜索结果的 并 已收藏的\r\n      if (isisCollected === '') {\r\n         isisCollected = state.collection.some(item=>item.id===action.song.id)\r\n        if(isisCollected) {\r\n          msg = '已收藏!'\r\n          return;\r\n        }\r\n      }\r\n      \r\n      \r\n      if (isisCollected) { // 喜欢 => 不喜欢\r\n        // filter        \r\n        collection = state.collection.filter((item) => {\r\n          if (item.id === action.song.id &&　item.inPlaylist) {\r\n            // inPlaylist 改为 false\r\n             item.inPlaylist = false\r\n          }\r\n          return item.id !== action.song.id\r\n        })\r\n      } else { // add\r\n        state.playlist.forEach(item => {\r\n          if (item.id === action.song.id) {\r\n            // playlist 有它，inPlaylist = true\r\n            item.inPlaylist = true;\r\n          }\r\n        })\r\n        collection = [action.song, ...state.collection]\r\n      }\r\n      return {\r\n        ...state,\r\n        playlist: state.playlist.map((item) => {\r\n          if (item.id === action.song.id) {\r\n            item.isCollected = !isisCollected;\r\n          }\r\n          return item;\r\n        }),\r\n        collection: collection,\r\n        message: msg,\r\n        isLoading: false\r\n      }\r\n    case SONG_TOGGLE_ISPLAYING:\r\n      return {\r\n        ...state,\r\n        isPlaying: state.isPlaying ? false : true\r\n      }\r\n\r\n    case SONG_ADD_TO_PLAYLIST_SUCCESS:\r\n      let list = []; // -----------------------------------------? ? ?\r\n      let message = '';\r\n      const song = action.song;\r\n      console.log(song);\r\n      \r\n      // 检查被添加的歌曲是否在播放列表中\r\n      if (state.playlist.some(item => item.id===song.id)) {\r\n        list = state.playlist;\r\n        message = '列表中已存在此歌曲。'\r\n      } else {\r\n        // 检查是否在收藏列表里\r\n        state.collection.forEach(item=>item.id===song.id&&\r\n                                    (song.isisCollected=true)&&(song.inPlaylist=true))\r\n        list = [song, ...state.playlist]\r\n      }\r\n      return {\r\n        ...state,\r\n        playlist: list,\r\n        message: message,\r\n        isLoading: false\r\n      }\r\n\r\n    case SONG_GET_SINGLE_SEARCH_RESULT_SUCCESS:    \r\n      return {\r\n        ...state,\r\n        searchResult: {singles: action.singles, albums: state.searchResult.albums},\r\n        isLoading: false\r\n      }\r\n    case SONG_GET_ALBUM_SEARCH_RESULT_SUCCESS:\r\n      return {\r\n        ...state,\r\n        searchResult: {albums: action.albums, singles: state.searchResult.singles},\r\n        isLoading: false\r\n      }\r\n    case SONG_GET_COMMENT_LIST_SUCCESS:\r\n      return {\r\n        ...state,\r\n        commentList: {hotComments: action.hotComments, comments: action.comments},\r\n        isLoading: false\r\n      }\r\n\r\n    // case SONG_PLAYLIST_TO_CURRENT_SONG:\r\n    //   return {\r\n    //     ...state,\r\n    //     currentSong: {\r\n    //       songID: state.playlist[0].id,\r\n    //       name: state.playlist[0].name,\r\n    //       artist: state.playlist[0].artist,\r\n    //       albumName: state.playlist[0].albumName,\r\n    //       albumImgURL: state.playlist[0].albumImgURL,\r\n    //     }\r\n    //   }\r\n  \r\n    \r\n    case SONG_REMOVE_PLA_COL_ALL:\r\n      return {\r\n        ...state,\r\n        playlist: [],\r\n        collection: [],\r\n        currentSong: {}\r\n      }\r\n    \r\n    \r\n    case SONG_SEND_COMMENT_SUCCESS:\r\n      // return {\r\n      //   ...state,\r\n      //   commentList: {\r\n      //     comments: [action.]\r\n      //   }\r\n      // }\r\n    case SONG_REQUEST_INITIATE:\r\n      return {\r\n        ...state,\r\n        isLoading: true\r\n      }\r\n    case SONG_MESSAGE:\r\n      return {\r\n        ...state,\r\n        message: action.msg\r\n      }\r\n    default:\r\n     return state;\r\n  }\r\n}\r\n\r\nexport default playReducer;","import React, { Component } from 'react';\r\nimport Dialog from 'material-ui/Dialog';\r\nimport FlatButton from 'material-ui/FlatButton';\r\nimport TextField from 'material-ui/TextField';\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      email:'',\r\n      password: '',\r\n      // autoLogin => 设置登录储存cookie，重载时检测cookies\r\n      saveCookie: false\r\n    };\r\n    this.container = document.querySelector('.app')\r\n    this.closeHandle = this.closeHandle.bind(this);\r\n    this.loginHandle = this.loginHandle.bind(this);\r\n    this.toRegister = this.toRegister.bind(this);\r\n    // this.changeHandle = this.changeHandle.bind(this);\r\n  }\r\n\r\n  closeHandle() {\r\n    this.props.onClose()\r\n  }\r\n  toRegister() {\r\n    this.props.changeDialog('register');\r\n  }\r\n  loginHandle() {\r\n    const {telEml, pwd, saveCookie} = this.state;\r\n    this.props.onLogin({telEml, pwd, saveCookie})\r\n  }\r\n\r\n  render () { \r\n    const actions = [\r\n      <FlatButton\r\n        label=\"Ok\"\r\n        primary={true}\r\n        keyboardFocused={true}\r\n        onClick={this.closeHandle}\r\n      />,\r\n    ];\r\n    return (\r\n      <div className=\"login\">\r\n        <Dialog\r\n          title=\"Dialog With Date Picker\"\r\n          actions={actions}\r\n          modal={false}\r\n          open={true}\r\n          onRequestClose={this.handleClose}\r\n        >\r\n        <div>\r\n          <TextField\r\n            onChange={(e)=>this.setState({email: e.target.value})}\r\n            hintText=\"Hint Text\"\r\n            floatingLabelText=\"Floating Label Text\"/>\r\n          <TextField\r\n            onChange={(e)=>this.setState({password: e.target.value})}\r\n            hintText=\"Hint Text\"\r\n            floatingLabelText=\"Floating Label Text\"\r\n            type=\"password\"/>\r\n          <FlatButton\r\n            label=\"登录\"\r\n            primary={true}\r\n            keyboardFocused={true}\r\n            onClick={()=> this.props.onLogin(this.state) }\r\n          />\r\n        </div>\r\n          \r\n        </Dialog>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\nexport default Login;\r\n\r\n","import React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { connect } from 'react-redux';\r\nimport { toggleCollect } from '../../reducer/song'\r\nimport { addToPlaylist } from '../../reducer/song'\r\nimport { toCurrentSongPlay } from '../../reducer/song'\r\n\r\nimport { List, ListItem } from 'material-ui/List';\r\nimport PlaylistPlay from 'material-ui/svg-icons/av/playlist-play';\r\nimport Star from 'material-ui/svg-icons/toggle/star';\r\nimport Close from 'material-ui/svg-icons/content/clear';\r\nimport Play from 'material-ui/svg-icons/av/play-arrow';\r\nimport Add from 'material-ui/svg-icons/content/add';\r\nimport Divider from 'material-ui/Divider';\r\nimport Subheader from 'material-ui/Subheader';\r\nimport IconButton from 'material-ui/IconButton';\r\n\r\nclass Collection extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.container = document.createElement('div');\r\n    document.body.appendChild(this.container)\r\n    this.container.className = 'collection-container portal-shade'\r\n    this.handleToggleCollect = this.handleToggleCollect.bind(this);\r\n    this.handleAddToPlay = this.handleAddToPlay.bind(this);\r\n    this.handleAddToPlaylist = this.handleAddToPlaylist.bind(this);\r\n  }\r\n\r\n  componentWillUnmount() {document.body.removeChild(this.container)}\r\n\r\n  handleToggleCollect(song) {    \r\n    this.props.toggleCollect(song, true)\r\n  }\r\n\r\n  handleAddToPlay(song) {\r\n    this.props.addToPlaylist(song)\r\n    this.props.toCurrentSongPlay(song)\r\n  }\r\n\r\n  handleAddToPlaylist(song) {\r\n    this.props.addToPlaylist(song)\r\n  }\r\n\r\n  render() {\r\n    return ReactDOM.createPortal (\r\n\r\n\r\n      <div className=\"collection\">\r\n        <List style={{width:600, margin:'0 auto',paddingTop: 20}}>\r\n          <Subheader>\r\n            <div style={{display: 'inline-block'}}>\r\n              <span>我收藏的音乐人歌曲</span>\r\n              <IconButton style={{verticalAlign:'middle'}}><PlaylistPlay /></IconButton>\r\n            </div>\r\n            {/* 关闭按钮\r\n            信息传给父组件 Headbar\r\n            更改 state */}\r\n            <IconButton\r\n              style={{padding:0,float: 'right'}}\r\n              onClick={()=>this.props.onClose()}>\r\n              <Close />\r\n            </IconButton>\r\n          </Subheader>\r\n          <Divider></Divider>\r\n\r\n\r\n          <div style={{overflowY:'auto', height:470}}  className='item-wrapper'>\r\n            {this.props.collection.map((item) => \r\n              <ListItem\r\n                key={item.id}\r\n                primaryText={\r\n                  <div><div style={{display:'inline-block', width: 250}}>{item.name}</div><div style={{display:'inline-block'}}>{item.artist}</div></div>}\r\n                leftIcon={\r\n                  <div style={{margin:0}}>\r\n                    <IconButton\r\n                      onClick={()=>this.handleToggleCollect(item)}\r\n                      style={{padding:0}}>\r\n                      <Star />\r\n                    </IconButton>\r\n                  </div>}\r\n                rightIcon={\r\n                  <div style={{width:100,margin:'0 15px'}}>\r\n                    <IconButton\r\n                      onClick={()=>this.handleAddToPlay(item)}\r\n                      style={{padding:0}}>\r\n                      < Play />\r\n                    </IconButton>\r\n                    {item.inPlaylist ?<div style={{position: 'absolute', left: 50, top:16}}>已添加</div>:\r\n                    <IconButton\r\n                      onClick={()=>this.handleAddToPlaylist(item)}\r\n                      style={{padding:0}}>\r\n                      <Add />\r\n                    </IconButton>\r\n                    }\r\n                  </div>}\r\n              />\r\n            )}\r\n          </div>\r\n\r\n          \r\n        </List>\r\n      </div>,\r\n      this.container\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToprops = (state) => ({\r\n  collection: state.song.collection,\r\n  playlist: state.song.playlist\r\n})\r\nconst mapDispatchToprops = (dispatch) => ({\r\n  toggleCollect: (id, isCollected)=>dispatch(toggleCollect(id, isCollected)),\r\n// addToPlay: (id)=>dispatch(addToPlay(id)),\r\naddToPlaylist: (id)=>dispatch(addToPlaylist(id)),\r\ntoCurrentSongPlay: (id)=> dispatch(toCurrentSongPlay(id))\r\n})\r\n\r\nexport default connect(mapStateToprops, mapDispatchToprops)(Collection);\r\n","import React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { connect } from 'react-redux'\r\nimport {getSingleSearchResult} from '../../reducer/song'\r\nimport {getAlbumSearchResult} from '../../reducer/song'\r\nimport {addToPlaylist} from '../../reducer/song'\r\nimport {toCurrentSongPlay} from '../../reducer/song'\r\nimport {toggleCollect} from '../../reducer/song'\r\n\r\nimport { List, ListItem } from 'material-ui/List';\r\nimport { Tabs, Tab } from 'material-ui/Tabs';\r\nimport Play from 'material-ui/svg-icons/av/play-arrow';\r\nimport StarBroder from 'material-ui/svg-icons/toggle/star-border';\r\nimport Close from 'material-ui/svg-icons/content/clear';\r\nimport Add from 'material-ui/svg-icons/content/add';\r\nimport Divider from 'material-ui/Divider';\r\nimport Subheader from 'material-ui/Subheader';\r\nimport IconButton from 'material-ui/IconButton';\r\nimport Avatar from 'material-ui/Avatar';\r\nimport IconMenu from 'material-ui/IconMenu';\r\nimport MenuItem from 'material-ui/MenuItem';\r\nimport MoreVertIcon from 'material-ui/svg-icons/navigation/more-vert';\r\nimport CircularProgress from 'material-ui/CircularProgress';\r\n\r\n\r\nclass SearchResult extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tab: 0,\r\n      getAlbumsDone: false\r\n    }\r\n    this.container = document.createElement('div');\r\n    document.body.appendChild(this.container);\r\n    this.container.className = 'Search-result-container portal-shade';\r\n    this.handleTabChange = this.handleTabChange.bind(this)\r\n    this.handleAddToPlay = this.handleAddToPlay.bind(this)\r\n    this.handleAddToPlaylist = this.handleAddToPlaylist.bind(this)\r\n    this.handleCollected = this.handleCollected.bind(this)\r\n  }\r\n\r\n  // componentDidMount时 请求搜索数据\r\n  componentDidMount() {\r\n    this.props.getSingleSearchResult(this.props.keyword)\r\n  }\r\n\r\n  // 请求 albums\r\n  handleTabChange() {\r\n    // 设置 tab\r\n    const state = this.state;\r\n    this.setState({tab: state.tab === 0 ? 1 : 0})\r\n    // 多次切换到 albums 时，只请求一次\r\n    if (!state.getAlbumsDone) {\r\n      this.props.getAlbumSearchResult(this.props.keyword);\r\n      this.setState({getAlbumsDone: true})\r\n    }\r\n  }\r\n\r\n  handleAddToPlay(song) {    \r\n    this.props.addToPlaylist(song,'noAlbumURL')\r\n    // 在addToPlaylist里调用toCurrentSongPlay({albumImgURL, ...song})) \r\n  }\r\n  handleAddToPlaylist(song) {\r\n    this.props.addToPlaylist(song)\r\n  }\r\n  handleCollected(song) {  \r\n    this.props.toggleCollect(song, '')\r\n  }\r\n\r\n\r\n\r\n  componentWillUnmount() {document.body.removeChild(this.container)}\r\n\r\n\r\n  render() {    \r\n    const rightIconMenu = (\r\n      <IconMenu iconButtonElement={<IconButton><MoreVertIcon /></IconButton>}>\r\n        <MenuItem>收藏</MenuItem>\r\n        <MenuItem>加入播放列表</MenuItem>\r\n        <MenuItem>Delete</MenuItem>\r\n      </IconMenu>\r\n    );\r\n\r\n    /**\r\n     * 设置 single / album tab 内 ListItem 的渲染\r\n     * 有 / 无 结果\r\n     * [] == [] //=> false\r\n     × ''.length === 0 //=> true\r\n     */\r\n    let content = '';\r\n    const singles = this.props.singles;\r\n    const albums = this.props.albums;\r\n    const isLoading = this.props.isLoading;\r\n    \r\n    if (isLoading) {\r\n      content = <CircularProgress\r\n        size={60} thickness={7}\r\n        style={{position: 'absolute',left: '50%',top:'50%',margin:'-30px 0 0 -30px'}}\r\n        />\r\n    } else {\r\n\r\n      if (this.state.tab === 0) {\r\n\r\n        if (singles.length === 0) {\r\n          content = 'Oops 什么都没有!!'\r\n        } else if (singles.length > 0) {\r\n          content = singles.map(item => {\r\n            return (\r\n              <ListItem\r\n                primaryText={item.name}\r\n                secondaryText={`${item.artist} - ${item.albumName}`}\r\n                rightIcon={\r\n                  <div style={{width:150,margin:0}}>\r\n                    <IconButton\r\n                      onClick={()=>this.handleAddToPlay(item)}\r\n                      style={{padding:0}}>\r\n                      <Play />\r\n                    </IconButton>\r\n                    <IconButton\r\n                      onClick={()=>this.handleCollected(item)}\r\n                      style={{padding:0}}>                  \r\n                      <StarBroder />\r\n                    </IconButton>\r\n                    <IconButton\r\n                      onClick={()=>this.handleAddToPlaylist(item)}\r\n                      style={{padding:0}}>\r\n                      <Add />\r\n                    </IconButton>\r\n                  </div>}\r\n              />\r\n            )\r\n          })\r\n        }\r\n\r\n      } else {\r\n        if (albums.length === 0) {\r\n          content = 'Oops 什么都没有!!'\r\n        } else if (albums.length > 0) {\r\n          content = albums.map(item => {\r\n            // containedSong 是后端返回的必有属性\r\n            // 属性值是 '' / 与搜索相关的歌曲\r\n            const contained = item.containedSong;\r\n            const secondaryText = contained === ''\r\n              ? `${item.artistName}`\r\n              : `${item.artistName} 包含单曲 ${contained}`\r\n            return (\r\n              <ListItem\r\n                onClick={()=> console.log('listitem event')}\r\n                primaryText={item.name}\r\n                secondaryText={secondaryText}\r\n                leftAvatar={\r\n                  <Avatar src={item.coverURL} />\r\n                }\r\n                rightIconButton={rightIconMenu}\r\n              />\r\n            )\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    return ReactDOM.createPortal (\r\n\r\n\r\n      <div className=\"search-result\">\r\n        <List  style={{width:600, margin:'0 auto',paddingTop: 20}}>\r\n          <Subheader style={{overflow:'hidden'}}>\r\n            <span>搜索结果</span>\r\n            <IconButton\r\n              onClick={()=>this.props.onClose()}\r\n              style={{padding:0,float: 'right'}}>\r\n              <Close />\r\n            </IconButton>\r\n          </Subheader>\r\n          <Divider></Divider>\r\n\r\n\r\n          <Tabs onChange={this.handleTabChange}>\r\n            <Tab label=\"单曲\" value=\"a\">\r\n              <div style={{overflow:'auto', height:370}} className='item-wrapper'>\r\n                {content}\r\n              </div>\r\n            </Tab>\r\n            <Tab label=\"专辑\" value=\"b\">\r\n              <div style={{overflow:'auto', height:370}} className='item-wrapper'>\r\n                {content}  \r\n              </div>\r\n            </Tab>\r\n          </Tabs>\r\n\r\n\r\n\r\n        </List>\r\n      </div>,\r\n      this.container\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToprops = (state) => ({\r\n  singles: state.song.searchResult.singles,\r\n  albums: state.song.searchResult.albums,\r\n  collection: state.song.collection,\r\n  isLoading: state.song.isLoading\r\n})\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  getSingleSearchResult: (keyword) => dispatch(getSingleSearchResult(keyword)),\r\n  getAlbumSearchResult: (keyword) => dispatch(getAlbumSearchResult(keyword)),\r\n  addToPlaylist: (song, string) => dispatch(addToPlaylist(song, string)),\r\n  toCurrentSongPlay: (id) => dispatch(toCurrentSongPlay(id)),\r\n  toggleCollect: (song, bool) => dispatch(toggleCollect(song, bool))\r\n})\r\n\r\nexport default connect(mapStateToprops, mapDispatchToProps)(SearchResult);\r\n","import React from 'react';\r\nimport { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { getUserID } from '../../reducer/user';\r\nimport { login, register, logout } from '../../reducer/user';\r\nimport { getMyPlaAndCol } from '../../reducer/song'\r\nimport { removePlaAndColAll } from '../../reducer/song'\r\nimport { changeTheme } from \"../../reducer/user\";\r\nimport Login from './login';\r\nimport Collection from '../Collection/'\r\nimport SearchResult from '../SearchResult/';\r\n\r\nimport FlatButton from 'material-ui/FlatButton';\r\nimport TextField from 'material-ui/TextField';\r\nimport Star from 'material-ui/svg-icons/toggle/star';\r\nimport Search from 'material-ui/svg-icons/action/search';\r\nimport ColorLens from 'material-ui/svg-icons/image/color-lens';\r\nimport IconMenu from 'material-ui/IconMenu';\r\nimport MenuItem from 'material-ui/MenuItem';\r\n\r\n\r\n// import { changeTheme } from '../../reducer/song'\r\n\r\nconst styles = {\r\n  button: {\r\n    margin: 3,\r\n    height: 35,\r\n    lineHeight: '20px'\r\n  }\r\n};\r\nconst deteleRules = () => {\r\n  const sheet = document.styleSheets[0];\r\n  const rulesLen = (sheet.cssRules || sheet.rules).length;\r\n  if (sheet.cssRules.length===19) {\r\n    for (let i=0;i<5;i++) {\r\n      sheet.deleteRule(0)\r\n    }\r\n  }\r\n}\r\nclass Headbar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      showLoginModal: false,\r\n      showSearchButton: true,\r\n      showSearchModal: false,\r\n      showCollectionModal: false,\r\n      searchText: '',\r\n      searchResult: [],\r\n      // 标志， 避免多次请求\r\n      getMyPlaAndColDone: false\r\n    }\r\n    this.child_loginHandle = this.child_loginHandle.bind(this);\r\n    this.child_registerHandle = this.child_registerHandle.bind(this);\r\n    this.logoutHandle = this.logoutHandle.bind(this);\r\n    // this.handleChangeTheme = this.handleChangeTheme.bind(this)\r\n  }\r\n\r\n  // 载入页面后\r\n  // 获取用户cookies，获取userId（标志）\r\n  componentDidMount() {this.props.getUserID()}\r\n\r\n  // 获取userId后\r\n  // 获取用户播放列表、收藏的歌曲\r\n  componentDidUpdate() {\r\n    // 登录后， 有---componentDidUpdate--- // 或者在 render 里 ？ ？ ？\r\n    // 调用 getMyPlaAndCol()\r\n    // 设置 getMyPlaAndColDone 标志为 true\r\n    if (!this.state.getMyPlaAndColDone) {\r\n      if (this.props.userID) {\r\n        this.props.getMyPlaAndCol(this.props.userID)\r\n        this.setState({getMyPlaAndColDone: true})\r\n      }\r\n    }\r\n  }\r\n\r\n  // 父组件处理登录和注册\r\n  child_loginHandle(data) {\r\n    this.props.login(data)\r\n  }\r\n  child_registerHandle(data) {\r\n    this.props.register(data)\r\n  }\r\n  // 登出 removePlaAndColAll() -----------------------playlist 做一个userId检测\r\n  //设置 getMyPlaAndColDone 标志为 false\r\n  logoutHandle() {\r\n    this.props.logout()\r\n    this.props.removePlaAndColAll()\r\n    this.setState({showLoginModal: false, getMyPlaAndColDone: false})\r\n  }\r\n // --------------------------------------------------------------------------\r\n\r\n  render() {\r\n    this.child_loginHandle()\r\n    return (\r\n        <div className=\"headbar\">\r\n          <FlatButton label=\"豆瓣音乐人\" style={styles.button}/>\r\n          <div style={{float:'right'}}>\r\n          {\r\n            this.state.showSearchButton\r\n            ? <FlatButton\r\n                onClick={()=>{this.setState({showSearchButton: false})}}\r\n                style={styles.button}\r\n                label=\"搜索音乐\"\r\n                icon={<Search />}\r\n              />\r\n\r\n            : <div style={{display:'inline-block', height: 35, margin:3}}>\r\n                <Search style={{height: 35, float: 'left'}} />\r\n                <TextField\r\n                  hintText=\"输入关键字\"\r\n                  style={{fontSize: 14, height:32, paddingBottom:8, marginLeft: 10}}\r\n                  onBlur={()=>{this.setState({showSearchButton: true})}}\r\n                  onChange={(e)=>this.setState({searchText:e.target.value})}\r\n                  onKeyDown={(e)=>{if(e.keyCode === 13 && e.target.value !== ''){this.setState({showSearchModal: true})}}}\r\n                />\r\n              </div>\r\n          }\r\n  \r\n          \r\n          <IconMenu\r\n            iconButtonElement={\r\n              <FlatButton\r\n                onClick={this.handleChangeTheme}\r\n                style={styles.button}\r\n                label=\"更换皮肤\"\r\n                icon={<ColorLens />}\r\n              />\r\n            }\r\n            open={this.state.openMenu}\r\n            onRequestChange={this.handleOnRequestChange}\r\n          >\r\n            <MenuItem value=\"0\" primaryText=\"Defaut\" onClick={()=>{\r\n              this.props.changeTheme(0);\r\n              document.body.style.backgroundColor = 'rgb(48, 48, 48)'\r\n              deteleRules()\r\n              this.props.onChangeTheme(0)\r\n              }} />\r\n            {/* <MenuItem value=\"1\" primaryText=\"White\"  onClick={()=>{\r\n              deteleRules()\r\n              document.body.style.backgroundColor = '#fff'\r\n              // console.log(document.querySelector('.collection'));\r\n              \r\n              // document.querySelector('.collection').style.backgroundColor = '#fff'\r\n              // document.querySelector('.search-result').style.backgroundColor = '#fff'\r\n              // document.querySelector('.comment-list').style.backgroundColor = '#fff'\r\n              document.querySelectorAll('.playlist span').style.color = '#000'\r\n            //   const sheet = document.styleSheets[0];\r\n            //   const rulesLen = (sheet.cssRules || sheet.rules).length;\r\n            //   const rule1 = .playlist span {color: #000!important;}\r\n            //   const rule2 = svg, button,.playmain span:nth-of-type(2) {color: hsl(240, 0%, 0%)!important;fill:  hsl(101, 10%, 0%)!important;}\r\n\r\n            // const rule3 = .collection, .search-result, .comment-list {background-color: rgb(255, 255, 255)!important;}\r\n\r\n            // sheet.insertRule(rule1, rulesLen-1)\r\n            // sheet.insertRule(rule2, rulesLen-1)\r\n            // sheet.insertRule(rule3, rulesLen-1)\r\n            // sheet.insertRule(rule4, rulesLen-1)\r\n              this.props.changeTheme(1)\r\n              this.props.onChangeTheme(1)}}/> */}\r\n            <MenuItem value=\"2\" primaryText=\"Colors\" onClick={()=>this.props.changeTheme(2)} />\r\n          </IconMenu>\r\n\r\n\r\n          <FlatButton\r\n            style={styles.button}\r\n            label=\"我的收藏\"\r\n            icon={<Star />}\r\n            onClick={()=>this.setState({showCollectionModal: true})}\r\n          />\r\n          {\r\n            !this.props.userID\r\n            ? <FlatButton\r\n                onClick={()=>this.setState({showLoginModal: true})}\r\n                style={styles.button}\r\n                label=\"登录\"\r\n                // icon={<Star />}\r\n              />\r\n            : <FlatButton\r\n                onClick={this.logoutHandle}\r\n                style={styles.button}\r\n                label=\"登出\"\r\n                labelStyle={{}}\r\n                // icon={<Star />}\r\n              />\r\n          }\r\n          </div>\r\n\r\n\r\n          {/* 应用 react protal */}\r\n          <div>\r\n            {/* 登录后，无法设置showLoginModal 为 false，使弹窗自动消失\r\n            所以 添加 && !this.props.userID 条件\r\n            但登出时，弹窗又会显示出来\r\n            所以，在登出同时，将showLoginModal 设置回 false\r\n            */}\r\n            {this.state.showLoginModal && !this.props.userID &&\r\n              <Login\r\n                onLogin={this.child_loginHandle}\r\n                onRegister={this.child_registerHandle}\r\n                onClose={()=> this.setState({isLoginModal: false})} />}\r\n            {this.state.showCollectionModal &&\r\n              <Collection\r\n                onClose={()=> this.setState({showCollectionModal: false})} />}\r\n            {this.state.showSearchModal &&\r\n            // 传递keyword\r\n              <SearchResult\r\n                keyword={this.state.searchText}\r\n                onClose={()=> this.setState({showSearchModal: false})}/>}\r\n          </div>\r\n        </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  userID: state.user.userID,\r\n  currentSong: state.song.currentSong,\r\n  playlist: state.song.playlist\r\n})\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  getUserID: () => dispatch(getUserID()),\r\n  login: (data) => dispatch(login(data)),\r\n  register: (data) => dispatch(register(data)),\r\n  logout: () => dispatch(logout()),\r\n  getMyPlaAndCol: (userID) => dispatch(getMyPlaAndCol(userID)),\r\n  removePlaAndColAll: () => dispatch(removePlaAndColAll()),\r\n  changeTheme: (num) => dispatch(changeTheme(num))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Headbar);\r\n    ","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { toCurrentSongPlay } from '../../reducer/song'\r\nimport { removePlaylistAll } from '../../reducer/song'\r\nimport { toggleCollect } from '../../reducer/song'\r\nimport { remove } from '../../reducer/song'\r\n\r\nimport { List, ListItem } from 'material-ui/List';\r\nimport Share from 'material-ui/svg-icons/action/launch';\r\nimport StarBroder from 'material-ui/svg-icons/toggle/star-border';\r\nimport Star from 'material-ui/svg-icons/toggle/star';\r\nimport Clear from 'material-ui/svg-icons/content/clear';\r\nimport Divider from 'material-ui/Divider';\r\nimport Subheader from 'material-ui/Subheader';\r\nimport IconButton from 'material-ui/IconButton';\r\nimport Toggle from 'material-ui/Toggle';\r\nimport FlatButton from 'material-ui/FlatButton';\r\n\r\n\r\nclass Playlist extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.itemClickHandle = this.itemClickHandle.bind(this)\r\n    this.handleRemoveAll = this.handleRemoveAll.bind(this)\r\n    this.handleCollectButton = this.handleCollectButton.bind(this)\r\n    this.handleRemoveButton = this.handleRemoveButton.bind(this)\r\n  }\r\n\r\n  handleRemoveAll() {this.props.removePlaylistAll()}\r\n  \r\n  itemClickHandle(song) {  \r\n    if (song.id !== this.props.currentSong.id) {\r\n      this.props.toCurrentSongPlay(song)\r\n    }\r\n  }\r\n\r\n  handleCollectButton(song, e) {\r\n    e.stopPropagation()\r\n    this.props.toggleCollect(song, song.collected)\r\n  }\r\n\r\n  handleRemoveButton(e,song) {\r\n    e.stopPropagation()\r\n    this.props.remove(song)\r\n  }\r\n\r\n  render() {\r\n    return(\r\n      <div className=\"playlist\" style={{overflowY:'auto'}}>\r\n        <List>\r\n          <Subheader style={{overflow:'hidden'}}>\r\n            <div style={{display:'inline-block', float: 'left'}}>\r\n              <span>正在播放 n/n</span>\r\n            </div>\r\n            <div style={{float:'right'}} >\r\n              <FlatButton style={{verticalAlign:'middle' }} label=\"清除全部\" />\r\n              <div style={{display:'inline-block',verticalAlign:'middle' }}>\r\n                <span>隐藏</span>\r\n                <Toggle\r\n                  style={{verticalAlign:'middle',display:'inline-block',width:50}}\r\n                  onChange={this.handleRemoveAllChange}/>\r\n              </div>\r\n            </div>\r\n          </Subheader>\r\n          <Divider></Divider>\r\n\r\n          <div className='item-wrapper' style={{overflow:'auto', height:370}}>\r\n            {\r\n              this.props.playlist.map((item) => {\r\n\r\n              const star = item.isCollected ? <Star /> : <StarBroder />\r\n              return (\r\n                <ListItem\r\n                  key={item.id}\r\n                  onClick={()=>this.itemClickHandle(item)}\r\n                  primaryText={<div><div style={{display:'inline-block', width: 250}}>{item.name}</div><div style={{display:'inline-block'}}>{item.artist}</div></div>}\r\n                  leftIcon={\r\n                    <div style={{margin:0}}>\r\n                      <IconButton\r\n                        onClick={(e)=>this.handleCollectButton(item, e)}\r\n                        style={{padding:0}}>\r\n                        {star}\r\n                      </IconButton>\r\n                    </div>}\r\n                  rightIcon={\r\n                    <div style={{width:100,margin:0}}>\r\n                      <IconButton\r\n                        onClick={(e)=>{e.stopPropagation();console.log('share')}}\r\n                        style={{padding:0,}}>                  \r\n                        <Share />\r\n                      </IconButton>\r\n                      <IconButton\r\n                        onClick={(e)=>this.handleRemoveButton(e, item)}\r\n                        style={{padding:0}}>\r\n                        <Clear />\r\n                      </IconButton>\r\n                    </div>}\r\n                />)}\r\n            )}\r\n          </div>\r\n        </List>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isPlaying: state.song.isPlaying,\r\n  playlist: state.song.playlist,\r\n  currentSong: state.song.currentSong\r\n})\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  // play: () => dispatch(play()),\r\n  toCurrentSongPlay: (song) => dispatch(toCurrentSongPlay(song)),\r\n  removePlaylistAll: () => dispatch(removePlaylistAll()),\r\n  remove: (song) => dispatch(remove(song)),\r\n  toggleCollect: (song, isCollected) => dispatch(toggleCollect(song, isCollected))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Playlist);\r\n","\r\n// getThemeColor('https://img1.doubanio.com/view/site/large/public/3a2c39f61bde3db.jpg')\r\n//   .then((r) => console.log(r)\r\n//   )\r\n\r\n\r\nexport function getThemeColor (URL) {\r\n\r\n  const image = new Image()\r\n  image.width = image.height = 50;\r\n  image.crossOrigin = 'anonymous';// 处理 getImageData 跨域\r\n  image.src = URL;\r\n\r\n  \r\n  return new Promise((resolve, reject) => {\r\n    image.onload = function(){\r\n      const themeColor = init(image);    \r\n      resolve(themeColor)\r\n    }\r\n  })\r\n  \r\n   \r\n\r\n  \r\n\r\n    \r\n\r\n\r\n  function init (image) {\r\n    const imagedata_rgb_arr = get_imagedata_rgb_arr(image)\r\n    const hslArr = get_hslobj_arr(imagedata_rgb_arr);\r\n    const hslArrSort = get_hslobj_arr_sort(hslArr)\r\n    const arrContainer = get_hslobj_arr_container(hslArrSort)\r\n    const arrContainerSort = get_hslobj_arr_container_sort(arrContainer)\r\n    const resultArr = get_result_arr(arrContainerSort)\r\n\r\n    const firstColor = resultArr[0]\r\n\r\n    const firstNumH = Number(firstColor.h)\r\n    const firstNumL = Number(firstColor.l)\r\n\r\n    \r\n    const secondColor = get_second_color(resultArr, firstNumH, firstColor)\r\n    const secondNumH = Number(secondColor.h)\r\n    const thirdColor = get_third_color(resultArr, firstNumH,secondNumH, firstNumL, secondColor)\r\n    \r\n    \r\n\r\n    // 子键下的字符串数字 -> 数字\r\n    const to = (obj) => {\r\n      const keys = Object.keys(obj)\r\n      for (let i = 0; i< keys.length; i++) {\r\n        obj[keys[i]] = Number(obj[keys[i]])\r\n      }\r\n      return obj\r\n    }\r\n    // console.log({\r\n    //   color1: to(firstColor),\r\n    //   color2: to(secondColor),\r\n    //   color3: to(thirdColor)\r\n    // });\r\n    \r\n    return {\r\n      color1: to(firstColor),\r\n      color2: to(secondColor),\r\n      color3: to(thirdColor)\r\n    }\r\n  }\r\n\r\n  // getImageData\r\n  function get_imagedata_rgb_arr (image)  {\r\n    const canvas = document.createElement('canvas');\r\n    const context = canvas.getContext('2d');\r\n    context.drawImage(image, 0, 0)\r\n    \r\n    const imageData = context.getImageData(0, 0, image.width, image.height);\r\n    \r\n    return imageData.data;\r\n  }\r\n\r\n  function get_hslobj_arr (imgDataArr) {\r\n    // 得到 rgb对象 的数组\r\n    const rgbArr = [];\r\n    for (let i = 0, len = imgDataArr.length; i < len; i+=4) {\r\n      rgbArr.push({\r\n        r: imgDataArr[i],\r\n        g: imgDataArr[i + 1],\r\n        b: imgDataArr[i + 2]\r\n      })\r\n    }\r\n\r\n    // 得到 hsl对象 的数组\r\n    const hslArr = []\r\n    for (let i = 0, len = rgbArr.length; i < len; i++) {\r\n      const rgb = rgbArr[i]\r\n      const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b)\r\n      // hslArr.push(`${hsl.h}${hsl.s}${hsl.l}`)\r\n      hslArr.push({\r\n        h: hsl.h,\r\n        s: hsl.s,\r\n        l: hsl.l\r\n      })  \r\n    }\r\n\r\n    return hslArr\r\n  }\r\n\r\n  //  将 hslArr 重排序\r\n  //  得到\r\n  //  [{0,0,0},\r\n  //   {0,0,1},\r\n  //   {1,1,0},\r\n  //   {1,1,0}\r\n  //   ...    ]\r\n  // 的形式\r\n  function get_hslobj_arr_sort (hslArr) {\r\n    return hslArr.sort((a,b)=> {\r\n      const numA = Number(`${a.h}${a.s}${a.l}`.replace(/\\./g, ''))\r\n      const numB = Number(`${b.h}${b.s}${b.l}`.replace(/\\./g, ''))\r\n      return numA - numB\r\n    })\r\n  }\r\n\r\n  //  将相等的项 push 进一个新数组\r\n  //  新数组全部push 进 arrContainer\r\n  //  有一项的，就代表 有两项是相同的\r\n  function get_hslobj_arr_container (hslArrSort, ar) {    \r\n    let flag = false;\r\n    const arrContainer = [];\r\n    for (let i = 0, len = hslArrSort.length; i < len; i++) {\r\n        if (hslArrSort[i+1]) {\r\n          const item = hslArrSort[i];\r\n          const nextItem = hslArrSort[i + 1]\r\n          let condition;\r\n          if (ar !== 1) {\r\n            condition= \r\n            Math.abs(item.h - nextItem.h) <= 10 &&\r\n            Math.abs(item.s - nextItem.s) <= 0.3&&\r\n            Math.abs(item.l - nextItem.l) <=0.1\r\n          } else {\r\n            condition =\r\n              item.h === nextItem.h &&\r\n              item.s === nextItem.s &&\r\n              item.l === nextItem.l\r\n          }\r\n          // 这里 不要全等，应该相近\r\n          if (condition) {\r\n            // 若 上一项 与 这一项 也相等\r\n            // 不创建新数组，push进上一个数组\r\n            if (flag === true) {\r\n              arrContainer[arrContainer.length-1].push(hslArrSort[i])\r\n            } else {\r\n              const arr = [];\r\n              arr.push(hslArrSort[i])\r\n              arrContainer.push(arr)\r\n            }\r\n\r\n          flag = true\r\n        } else {\r\n          flag = false\r\n        }\r\n      }\r\n    }\r\n\r\n    return arrContainer;\r\n  }\r\n\r\n\r\n  // 将 result 按所含数组项的 length 重排序\r\n  // [[1], [2,2,2], [3,3].... ]\r\n  // 得到\r\n  // [\r\n  //   [{hsl_1}, {hsl_1}, {hsl_1}, {hsl_1}], \r\n  //   [{hsl_2}, {hsl_2}, {hsl_2}],\r\n  //   [{hsl_3}, {hsl_3}],\r\n  //   ...\r\n  // ] 的形式\r\n  function get_hslobj_arr_container_sort (arrContainer){\r\n    return arrContainer.sort((a,b)=> {\r\n      if(a.length > b.length) {\r\n        return -1\r\n      } else if (a.length < b.length) {\r\n        return 1\r\n      } else {\r\n        return 0\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  // 将 resultSort 简化：\r\n  // [\r\n  //   [{hsl_1}, {hsl}, {hsl}, {hsl}]\r\n  //   {hsl_2},\r\n  //   {hsl_3}\r\n  // ]\r\n  function get_result_arr (arrContainerSort)  {        \r\n    const resultArr = []    \r\n    for (let i = 0, len = arrContainerSort.length; i < len; i++) {      \r\n      // 取每一个 subArr 里相同的项 最多的那一项   \r\n      // const subArr = arrContainerSort[i];      \r\n      // const subArrSort = get_hslobj_arr_sort (subArr)      \r\n      // const containArrSort = get_hslobj_arr_container(subArrSort, 1)\r\n      // const lenSort = get_hslobj_arr_container_sort(containArrSort)   \r\n      // if (lenSort.length === 0) break;\r\n      // resultArr.push(lenSort[0][0])\r\n\r\n      // 取平均\r\n      let hsum=0, ssum=0,lsum=0\r\n      const subArr = arrContainerSort[i]\r\n      for (let j=0;j<subArr.length;j++) {\r\n        hsum += parseFloat(subArr[j].h);\r\n        ssum += parseFloat(subArr[j].s);\r\n        lsum += parseFloat(subArr[j].l);\r\n      }\r\n      \r\n      const h = (hsum/subArr.length).toFixed(2);\r\n      const s = (ssum/subArr.length).toFixed(2);\r\n      const l = (lsum/subArr.length).toFixed(2);\r\n      resultArr.push({h,s,l})\r\n      \r\n    }\r\n    \r\n    return resultArr;\r\n  }\r\n\r\n\r\n \r\n  function get_second_color(resultArr, firstNumH, firstColor) {\r\n    let firstWithoutL;\r\n    const firstNumL = firstColor.l\r\n    let secondColor;\r\n    // 重复色彩 有时会 < 300 个，\r\n    // 设置遍历次数 maxFor\r\n    const maxFor = resultArr.length < 700 ? resultArr.length : 700\r\n    for ( let i = 0;  i< maxFor; i++) {\r\n      const numH = resultArr[i].h;\r\n      const numL = resultArr[i].l;\r\n\r\n      const condition = \r\n(Math.abs(numH - firstNumH) >= 50 && (numL > 0.5 || firstNumL > 0.5) ) &&\r\n(numL <= 0.6 || firstNumL <= 0.6)\r\n || Math.abs(numL - firstNumL) > 0.3\r\n      if (condition) {\r\n        console.log('second condition');\r\n        \r\n        \r\n          // !firstWithoutL && (firstWithoutL = resultArr[i])\r\n\r\n          \r\n          // if(l -firstNumL < 0.4 || l -firstNumL > -0.4) {\r\n          //   // first 暗色\r\n          //   if(firstNumL <= 0.5) {\r\n          //     return {...resultArr[i], l:(l+0.5).toFixed(2)}\r\n          //   } else {\r\n          //     // first 亮色\r\n          //     return {...resultArr[i], l:(l-0.5).toFixed(2)}\r\n          //   }\r\n          // } else {\r\n          //   return resultArr[i]\r\n          // }\r\n          return resultArr[i]\r\n          \r\n\r\n\r\n          // if (numL > 0.05 && numL < 0.95) {\r\n            // console.log('getL'+resultArr[i]);\r\n\r\n            // return resultArr[i];\r\n          // }\r\n        // }\r\n      }\r\n    }\r\n    // return firstWithoutL\r\n\r\n    if (firstNumL <= 0.5) {\r\n      return {...firstColor, l:Number(firstColor.l)+0.5}\r\n    } else {\r\n      return {...firstColor, l:Number(firstColor.l)-0.5}\r\n    }\r\n  }\r\n\r\n\r\n  function get_third_color(resultArr, firstNumH,secondNumH, firstNumL, secondColor) {\r\n    let firstWithoutL;\r\n    \r\n    const maxFor = resultArr.length < 500 ? resultArr.length : 500\r\n    for (let i = 0; i < maxFor; i++) {      \r\n      const numH = Number(resultArr[i].h);\r\n      const numL = Number(resultArr[i].l);\r\n      const condition1 = \r\n(Math.abs(numH - firstNumH) >= 50 && (numL > 0.5 || firstNumL > 0.5) ) &&\r\n      (numL <= 0.6 || firstNumL <= 0.6)\r\n      || Math.abs(numL - firstNumL) > 0.3\r\n\r\nconst condition2 = Math.abs(numH - secondNumH) >= 50\r\n      if (condition1 && condition2) {\r\n        console.log('third condition');\r\n        return resultArr[i]\r\n      // if(numH - firstNumH > 30 || numH - firstNumH < -30) {         \r\n      //   if (numH - secondNumH > 30 || numH - secondNumH < -30) {\r\n      //     // if (numL - firstNumL >= 0.4 || numL - firstNumL <= -0.4){\r\n\r\n      //       const l = Number(resultArr[i].l);\r\n      //       if(l -firstNumL < 0.4 || l -firstNumH > -0.4) {\r\n      //         // first 暗色\r\n      //         if(firstNumL <= 0.5) {\r\n      //           return {...resultArr[i], l:(l+0.4).toFixed(2)}\r\n      //         } else {\r\n      //           // first 亮色\r\n      //           return {...resultArr[i], l:(l-0.4).toFixed(2)}\r\n      //         }\r\n      //       } else {\r\n      //         return resultArr[i]\r\n      //       }\r\n      //     // }\r\n      //   }\r\n      // }\r\n      } \r\n    }\r\n    \r\n    // return firstWithoutL\r\n    if (firstNumL <= 0.5) {\r\n      return {...secondColor, l:Number(secondColor.l)-0.2}\r\n    } else {\r\n      return {...secondColor, l:Number(secondColor.l)+0.2}\r\n    }\r\n  }\r\n\r\n  function rgbToHsl(r, g, b) {\r\n    r /= 255; g /= 255; b /= 255;\r\n    var max = Math.max(r, g, b), min = Math.min(r, g, b);\r\n    var h, s, l = (max + min) / 2;\r\n\r\n    if (max == min){ \r\n        h = s = 0; // achromatic\r\n    } else {\r\n        var d = max - min;\r\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n        switch(max) {\r\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n            case g: h = (b - r) / d + 2; break;\r\n            case b: h = (r - g) / d + 4; break;\r\n        }\r\n        h /= 6;\r\n    }\r\n\r\n    return {\r\n      h: (h*360).toFixed(0),\r\n      s: s.toFixed(2),\r\n      l: l.toFixed(2)\r\n    };\r\n  }\r\n\r\n  \r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { connect } from 'react-redux'\r\nimport { Component } from 'react';\r\nimport {List, ListItem} from 'material-ui/List';\r\n\r\nimport Clear from 'material-ui/svg-icons/content/clear';\r\nimport Divider from 'material-ui/Divider';\r\nimport Subheader from 'material-ui/Subheader';\r\nimport TextField from 'material-ui/TextField';\r\nimport IconButton from 'material-ui/IconButton';\r\nimport FlatButton from 'material-ui/FlatButton';\r\nimport {Card, CardHeader, CardMedia, CardTitle, CardText} from 'material-ui/Card';\r\nimport { getCommentList } from '../../reducer/song'\r\nimport { sendComment } from '../../reducer/song'\r\n\r\n// 根据毫秒数据 获取 日期\r\nconst getDate = (time) => {\r\n  const date = new Date(time)\r\n  return `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}`\r\n}\r\n\r\nclass CommentList extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {commentText: ''}\r\n    this.container = document.createElement('div');\r\n    document.body.appendChild(this.container)\r\n    this.container.className = 'collection-container portal-shade'\r\n    this.handleSendComment = this.handleSendComment.bind(this)\r\n  }\r\n\r\n  componentWillUnmount() {document.body.removeChild(this.container)}\r\n\r\n  componentDidMount() {this.props.getCommentList(this.props.currentId)}\r\n\r\n  handleSendComment() {this.props.sendComment(this.state.text, this.props.currentId)}\r\n\r\n  render() {\r\n    const hotCommentList = this.props.hotCommentList;\r\n    const commentList = this.props.commentList;\r\n    return ReactDOM.createPortal (\r\n      <div className=\"comment-list\">\r\n\r\n\r\n      <div style={{width:600, margin:'0 auto',paddingTop: 20}}>\r\n        <List>\r\n          <Subheader style={{overflow:'hidden'}}>\r\n            <span>评论</span>\r\n            <IconButton\r\n              style={{padding:0,float: 'right'}}>\r\n              <Clear onClick={()=>this.props.onClose()} />\r\n            </IconButton>\r\n          </Subheader>\r\n          <Divider></Divider>\r\n\r\n\r\n          <div style={{overflow:'auto', height:470}}>\r\n            <div className=\"hot-comment-item-wrapper\">\r\n              {hotCommentList.length > 0 && hotCommentList.map(item => {\r\n                const subtitle = getDate(item.time)\r\n                return <Card key={item.commentID} style={{paddingBottom: 30}}>\r\n                    <CardHeader\r\n                      title={item.userName}\r\n                      subtitle={subtitle}\r\n                      avatar={item.userAvatarURL}\r\n                      style={{padding: 10}}\r\n                    />\r\n                    <CardText style={{padding: '0 10px 0 50px'}}>\r\n                      {item.content}\r\n                    </CardText>\r\n                  </Card>\r\n                })\r\n              }\r\n            </div>\r\n            <div className='comment-item-wrapper'>\r\n              {commentList.length === 0\r\n              ? '评论是空的！！'\r\n              : commentList.map(item => {\r\n                const subtitle = getDate(item.time)\r\n                return <Card key={item.commentID} style={{paddingBottom: 30}}>\r\n                    <CardHeader\r\n                      title={item.userName}\r\n                      subtitle={subtitle}\r\n                      avatar={item.userAvatarURL}\r\n                      style={{padding: 10}}\r\n                    />\r\n                    <CardText style={{padding: '0 10px 0 50px'}}>\r\n                      {item.content}\r\n                    </CardText>\r\n                  </Card>\r\n                })}\r\n            </div>\r\n          </div>\r\n        </List>\r\n\r\n\r\n        <div>\r\n        <TextField\r\n          hintText=\"说点什么吧！\"\r\n          multiLine={true}\r\n          rows={2}\r\n          rowsMax={4}\r\n        /><FlatButton\r\n          onClick={this.handleSendComment}\r\n          onChange={(e)=> this.setState({commentText: e.target.value})}\r\n          value={this.state.commentText}\r\n        >发送评论</FlatButton>\r\n        </div>\r\n\r\n\r\n        </div>\r\n      </div>,\r\n      this.container\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  hotCommentList: state.song.commentList.hotComments,\r\n  commentList: state.song.commentList.comments,\r\n  currentId: state.song.currentSong.id\r\n})\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  getCommentList: (songID) => dispatch(getCommentList(songID)),\r\n  sendComment: (text) => dispatch(sendComment(text))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CommentList);\r\n","import React from 'react';\r\nimport { Component } from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { getThemeColor } from '../../script/script'\r\nimport CommentList from '../CommentList/'\r\n\r\nimport { Card, CardActions, CardMedia, CardTitle, CardText} from 'material-ui/Card';\r\nimport FlatButton from 'material-ui/FlatButton';\r\n\r\n\r\nclass Playmain extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { isShowCommitListModal: false }\r\n  }\r\n\r\n  // -------------------------------------------------------------render----------------\r\n  componentDidUpdate() {\r\n    //===========================================================\r\n    const lrcWrapper = document.querySelector('.lrc-wrapper');\r\n    const audio = document.querySelector('#audio-element');\r\n    if (this.props.currentSong.lyrics !== '') {\r\n      const lrc = this.props.currentSong.lyrics;\r\n      // ==func\r\n      const lrcArr = lrc.split(\"[\");    // 用换行符拆分获取到的歌词\r\n      let lrcObjArr = [];\r\n      lrcArr.forEach((item ) => {\r\n        var t = item.substring(0, item.indexOf(\"]\")); // 01:00.15\r\n        lrcObjArr.push({\r\n          t: (t.split(\":\")[0] * 60 + parseInt(t.split(\":\")[1])),\r\n          c: item.substring(item.indexOf(\"]\") + 1, item.length)\r\n        });\r\n      });\r\n\r\n\r\n      lrcObjArr = lrcObjArr.filter(i=> !isNaN(i.t))//去掉转换过程中t=NaN项\r\n\r\n      const ulE = document.createElement('ul')\r\n      // 遍历medisArray，并且生成li标签，将数组内的文字放入li标签\r\n      lrcObjArr.forEach((item) => {        \r\n        var li = document.createElement('li')\r\n        li.innerText = item.c\r\n        // li.stye.listStyle = 'none'\r\n        li.dataset.timeline = item.t\r\n        ulE.appendChild(li);\r\n      });\r\n      lrcWrapper.innerHTML = ''\r\n      lrcWrapper.appendChild(ulE)\r\n\r\n      audio.addEventListener('timeupdate', function(e) {\r\n        var time = parseInt(e.target.currentTime);\r\n        var lines = document.querySelectorAll('[data-timeline]');\r\n        var top = 0;\r\n        var _thisHeight = 0;\r\n        var nextLine = {\r\n            i: 0,\r\n            time: 0\r\n        };\r\n        for (var i in lines) {\r\n          var line = lines[i];\r\n          if (line.dataset != undefined) {\r\n              var timeline = parseInt(line.dataset.timeline);\r\n              if (timeline == time) {\r\n                  _thisHeight = line.clientHeight\r\n                  \r\n                  line.className = \"now\";\r\n                  //获取下一句歌词\r\n                  nextLine.i = parseInt(i) + 1;\r\n                  try {\r\n                      nextLine.time = lines[nextLine.i].dataset.timeline;\r\n                  }\r\n                  catch (e) {\r\n                  }\r\n                  if (nextLine.time > 0) {\r\n                      var interval = nextLine.time - timeline;\r\n                      (function(k) {\r\n                          setTimeout(function() {\r\n                              lines[k].className = \"\";\r\n                          }, interval * 1000);\r\n                      })(i);\r\n                  }\r\n                  document.querySelector('.lrc-wrapper').style.marginTop = -(top - _thisHeight) + 'px';\r\n              } else if (timeline < time) {\r\n                  top += line.clientHeight;\r\n              }\r\n          }\r\n        }\r\n      })\r\n    }\r\n    //==============================================================\r\n\r\n    if (this.props.currentSong.albumImgURL &&\r\n        this.props.theme === 2) {\r\n      const colors = getThemeColor(this.props.currentSong.albumImgURL)\r\n        .then((colors) => {\r\n          console.log(colors);\r\n          const {color1, color2, color3} = colors;\r\n          const sheet = document.styleSheets[0];\r\n          const rulesLen = (sheet.cssRules || sheet.rules).length;\r\n          const rule1 = \r\n            `body, .playmain>div,.result,.item-wrapper  {\r\n              background-color: hsl(${color1.h}, ${color1.s*100}%, ${color1.l*100}%)!important;\r\n            }`\r\n          const rule2 = \r\n            `.playlist div,.headbar div,.lrc-wrapper,.playmain span,.collection div, .search-result div, .comment-list div  {\r\n              color: hsl(${color2.h}, ${color2.s*100}%, ${color2.l*100}%)!important;\r\n            }`\r\n          const rule3 = \r\n            `svg, button,.playmain span:nth-of-type(2) {\r\n              color: hsl(${color3.h}, ${color3.s*100}%, ${color3.l*100}%)!important;\r\n              fill:  hsl(${color3.h}, ${color3.s*100}%, ${color3.l*100}%)!important;\r\n            }`\r\n\r\n          const rule4 = \r\n            `.collection, .search-result, .comment-list{\r\n              background-color: hsl(${color1.h}, ${color1.s*100}%, ${color1.l*100}%)!important;\r\n            }`\r\n          const rule5 = \r\n            `.collection, .search-result, .comment-list {\r\n              border: 1px solid hsl(${color2.h}, ${color2.s*100}%, ${color2.l*100}%)!important;\r\n            }`\r\n            \r\n            console.log(sheet.cssRules);\r\n            \r\n            if (sheet.cssRules.length===19) {\r\n              for (let i=0;i<5;i++) {\r\n                console.log(sheet.cssRules.length);\r\n                sheet.deleteRule(0)\r\n                console.log(sheet.cssRules.length);\r\n                \r\n              }\r\n            }\r\n          sheet.insertRule(rule1, 0)\r\n          sheet.insertRule(rule2,0)\r\n          sheet.insertRule(rule3, 0)\r\n          sheet.insertRule(rule4, 0)\r\n          sheet.insertRule(rule5, 0)\r\n      })\r\n    }\r\n  }\r\n  render() {\r\n    const currentSong = this.props.currentSong;\r\n    return(\r\n      <div className=\"playmain\">\r\n        <Card style={{textAlign:'center', marginTop: 10}}>\r\n          <CardMedia style={{height: 160}}>\r\n            <img style={{width: 160,minWidth: 160}} id='drawing' src={currentSong.albumImgURL} alt=\"\" />\r\n          </CardMedia>\r\n          <CardTitle\r\n            style={{padding: 5,height: 45}}\r\n            titleStyle={{fontSize:16, height: 30}}\r\n            title={currentSong.name}\r\n            subtitle={currentSong.albumName}\r\n          />\r\n          <CardText style={{height: 137,padding: 10,overflow: 'hidden'}}>\r\n\r\n\r\n                <div className='lrc-wrapper'></div>\r\n\r\n                \r\n          </CardText>\r\n          <CardActions style={{padding: '15px 0 0'}}>\r\n            <FlatButton label=\"关注\" />\r\n            {/* 改变 state\r\n            显示 commitList 组件 */}\r\n            <FlatButton\r\n              label=\"评论\"\r\n              onClick={()=>currentSong.id && this.setState({isShowCommitListModal: true})}\r\n            />\r\n          </CardActions>\r\n        </Card>\r\n\r\n        {/* protal组件\r\n        state 满足时，显示在DOM this.container下 */}\r\n        {/* 传递 songID 数据\r\n        和 onClose 回调事件 */}\r\n        {this.state.isShowCommitListModal &&\r\n        <CommentList\r\n          currentSongID={currentSong.songID}\r\n          onClose={()=>this.setState({isShowCommitListModal: false})}\r\n        ></CommentList>}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToprops = (state) => ({\r\n  theme: state.user.theme,\r\n  currentSong: state.song.currentSong\r\n})\r\n\r\nexport default connect(mapStateToprops, null)(Playmain);\r\n","import React from 'react';\r\nimport AudioSpectrum from 'react-audio-spectrum';\r\n/**\r\n * 问题：音乐能播放，但是没有声音\r\n * 警告：MediaElementAudioSource outputs zeroes due to CORS access restrictions for 'http....3000'\r\n * 在audio标签上加上 crossOrigin=\"anonymous“\r\n */\r\n\r\nconst Spectrum = () => (\r\n  <div className=\"spectrum\">\r\n    <AudioSpectrum\r\n      id=\"audio-canvas\"\r\n      height={150}\r\n      width={1000}\r\n      audioId={'audio-element'}\r\n      capColor={'red'}\r\n      capHeight={2}\r\n      meterWidth={2}\r\n      meterCount={512}\r\n      meterColor={[\r\n        {stop: 0, color: '#f00'},\r\n        {stop: 0.5, color: '#0CD7FD'},\r\n        {stop: 1, color: 'red'}\r\n      ]}\r\n      gap={4}\r\n    />\r\n  </div>\r\n)\r\n\r\nexport default Spectrum;\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { toggleIsPlaying } from '../../reducer/song';\r\nimport { toCurrentSongPlay } from '../../reducer/song';\r\n\r\nimport Slider from 'material-ui/Slider';\r\nimport Volume from 'material-ui/svg-icons/av/volume-up';\r\nimport RepeatPlaylist from 'material-ui/svg-icons/av/loop';\r\nimport RepeatTrack from 'material-ui/svg-icons/av/replay';\r\nimport Random from 'material-ui/svg-icons/action/swap-horiz';\r\nimport Play from 'material-ui/svg-icons/av/play-arrow';\r\nimport Pause from 'material-ui/svg-icons/av/pause';\r\nimport Next from 'material-ui/svg-icons/av/fast-forward';\r\nimport Previous from 'material-ui/svg-icons/av/fast-rewind';\r\nimport IconButton from 'material-ui/IconButton';\r\n\r\n\r\n// 181s => 3:01\r\nconst secondToMinute = (time) => {\r\n  let min = Math.floor(time / 60).toFixed(0);\r\n  min = min>9? min:0+min;\r\n  let sec = Math.round(time % 60).toFixed(0);\r\n  sec = sec>9? sec:0+sec;\r\n  return min + ':' + sec;\r\n}\r\n\r\n// 返回数组随机的 index\r\nconst getRandomIndex = (length, prevI) => {\r\n  // length = 10\r\n  // random -> 0.001 ～ 0.999\r\n  // => 0.01 ～ 9.99\r\n  // ex 0 ～ 9\r\n  const i = Math.floor(length * Math.random())\r\n  // if (i===prevI) {\r\n  //   return randomIndex(length, prevI);\r\n  // }\r\n  return i;\r\n}\r\n\r\nclass Controllerbar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {// 赋值一个变量，无法通过 props 改变，更改其属性值\r\n      volume: 0.5,\r\n      playModel: 0,\r\n      duration: 0,\r\n      currentTime: 0\r\n    }\r\n    this.togglePlayPauseHandle = this.togglePlayPauseHandle.bind(this)\r\n    this.playNextHandle = this.playNextHandle.bind(this)\r\n    this.playPreviousHandle = this.playPreviousHandle.bind(this)\r\n    this.modelChangeHandle = this.modelChangeHandle.bind(this)\r\n    this.timeSliderChangeHandle = this.timeSliderChangeHandle.bind(this)\r\n    this.volSliderChangeHandle = this.volSliderChangeHandle.bind(this)\r\n  }\r\n\r\n  componentDidMount() {\r\n    // 取得DOM\r\n    this.audioElement = this.refs.audioElement;    \r\n    this.changeTimeSlider = this.refs.changeTimeSlider;\r\n    this.changeVolSlider = this.refs.changeVolSlider;\r\n    const audio = this.audioElement;    \r\n\r\n    audio.volume = this.state.volume\r\n\r\n    // 载入数据后 获取音乐时长\r\n    audio.onloadeddata = () => {      \r\n      this.setState({duration: audio.duration.toFixed(2)})\r\n    }\r\n\r\n    // onplay 无法启动 spectrum\r\n    audio.onplaying = () => {\r\n      \r\n      // 每秒获取 currentTime 到 state \r\n      setInterval(() => {\r\n        this.setState({currentTime: audio.currentTime.toFixed(2),})\r\n      }, 1000)\r\n    }\r\n\r\n    // 播放完一首歌曲时\r\n    // 相当于 调用 playNextHandle()\r\n    // 注意：loop 属性为 false 时才会触发 ended事件\r\n    audio.onended = () => {this.playNextHandle()}\r\n  }\r\n\r\n  // 播放 / 暂停按钮\r\n  // => store[isPlaying]\r\n  togglePlayPauseHandle() {\r\n    if (!this.props.currentSong) return;\r\n\r\n    if (this.props.isPlaying) {\r\n      this.audioElement.pause()\r\n    } else {\r\n      this.audioElement.play()\r\n    }\r\n    this.props.toggleIsPlaying()\r\n  }\r\n\r\n  // 上 / 下一首\r\n  // 根据 playlist、currentId 计算 newCurrentSong\r\n  // playlistRepeat、oneTackPepeat、random 三种情况\r\n  // 无 currentSong return\r\n  // 当 currentSong 不在播放列表里，需要设置 newCurrentSong 为 playlist[0]\r\n  playNextHandle() {\r\n    const currentSong = this.props.currentSong;\r\n    if (!currentSong) return;\r\n    const playlist =  this.props.playlist;\r\n    const state = this.state;\r\n    let newCurrentSong;\r\n    // 列表循环\r\n    if (state.playModel === 0) {\r\n      // 遍历 playlist\r\n      // 获取 下一个的 newCurrentSong\r\n      playlist.forEach((item, i) => {\r\n        if (item.id === currentSong.id) {          \r\n          return newCurrentSong = (i + 1 === playlist.length)\r\n            ? playlist[0]\r\n            : playlist[i + 1]\r\n        }\r\n      })\r\n      // 如果 currentSong 已被 remove\r\n      !newCurrentSong && (newCurrentSong = playlist[0])\r\n      this.props.toCurrentSongPlay(newCurrentSong);\r\n\r\n      // 单曲循环\r\n    } else if (this.state.playModel === 1) {\r\n      this.audioElement.load()\r\n    } else {\r\n      // 随机\r\n      const newIndex = getRandomIndex(playlist.length);\r\n      const newCurrentSong = playlist[newIndex]\r\n      this.props.toCurrentSongPlay(newCurrentSong)\r\n    }\r\n  }\r\n  // 上一首\r\n  playPreviousHandle() {\r\n    const currentSong = this.props.currentSong;\r\n    if (!currentSong) return;\r\n    const playlist =  this.props.playlist\r\n    const state = this.state\r\n    let newCurrentSong;\r\n\r\n    if (state.playModel === 0) {\r\n      playlist.forEach((item, i) => {\r\n        if (item.id === currentSong.id) {\r\n          newCurrentSong = (i === 0)\r\n            ? playlist[playlist.length - 1]\r\n            : playlist[i - 1]\r\n        } else {\r\n          newCurrentSong = playlist[0]\r\n        }\r\n      })\r\n      this.props.toCurrentSongPlay(newCurrentSong)\r\n    } else if (this.state.playModel === 1) {\r\n      this.audioElement.load()\r\n    } else {\r\n      const newIndex = getRandomIndex(playlist.length);\r\n      const newCurrentSong = playlist[newIndex]\r\n      this.props.toCurrentSongPlay(newCurrentSong)\r\n    }\r\n  }\r\n\r\n  // 模式改变\r\n  modelChangeHandle() {\r\n    const playModel = this.state.playModel\r\n    let num = playModel === 2\r\n      ? 0\r\n      : playModel + 1\r\n    this.setState({playModel: num})\r\n  }\r\n\r\n  // 播放进度改变\r\n  timeSliderChangeHandle(e) {\r\n    console.log(e);\r\n    \r\n    // 用 ref 获取 Mater-UI 组件\r\n    // 获取 Slider 的 value（0.00 - 1.00）\r\n    const sliderValue = this.changeTimeSlider.state.value;\r\n    const newCurrentTime = this.state.duration * sliderValue;\r\n    this.audioElement.currentTime = newCurrentTime;\r\n    this.setState({currentTime: newCurrentTime});\r\n  }\r\n\r\n  // 音量调节\r\n  volSliderChangeHandle() {\r\n    const sliderValue = this.changeVolSlider.state.value;\r\n    const newVol = 1 * sliderValue;\r\n    this.audioElement.volume = newVol;\r\n    this.setState({volume: newVol});\r\n  }\r\n\r\n  render() {\r\n    const currentId = this.props.currentSong.id;\r\n    const state = this.state;\r\n    const timeSliderDisabled = !currentId;\r\n    let timeSliderValue = parseFloat((state.currentTime / state.duration).toFixed(2))\r\n    timeSliderValue = isNaN(timeSliderValue) ? 0 : timeSliderValue\r\n    \r\n    const volSliderValue = state.volume;\r\n    const time = currentId\r\n      ? `${secondToMinute(state.currentTime)} / ${secondToMinute(state.duration)}`\r\n      : '00:00';\r\n    // 播放模式\r\n    const playModelButton = state.playModel === 0\r\n      ? <RepeatPlaylist />\r\n      : state.playModel === 1\r\n        ? <RepeatTrack />\r\n        : <Random />\r\n    // 播放 / 暂停\r\n    const playOrPauseButton = this.props.isPlaying\r\n      ? <Pause onClick={this.togglePlayPauseHandle} />\r\n      : <Play onClick={this.togglePlayPauseHandle} />\r\n\r\n      return (\r\n      <div className=\"controllerbar\">\r\n        <div style={{display:'inline-block',width: 500,height:50,float:'left', margin: '0 20px 0 10px'}}>\r\n          <div style={{textAlign: 'right', color: '#fff'}}>{time}</div>\r\n          <Slider\r\n            disabled={timeSliderDisabled}\r\n            value={timeSliderValue}\r\n            ref='changeTimeSlider'\r\n            onDragStop={(e)=>this.timeSliderChangeHandle(e)}\r\n            style={{marginTop: -28}} />\r\n        </div>\r\n \r\n\r\n        <div style={{display:'inline-block',width: 160, height:50,float:'left'}}>\r\n          <IconButton onClick={this.modelChangeHandle}>{playModelButton}</IconButton>\r\n          <IconButton><Volume /></IconButton>\r\n          <Slider\r\n            onChange={this.volSliderChangeHandle}\r\n            value={volSliderValue}\r\n            ref='changeVolSlider'\r\n            style={{marginTop: -30,verticalAlign:'middle',width:50,height:50,display:'inline-block'}} />\r\n        </div>\r\n\r\n\r\n        <div style={{display:'inline-block',width: 300,float:'right'}}>\r\n          <div style={{textAlign:'center'}}>\r\n            <IconButton>\r\n              <Previous onClick={this.playPreviousHandle} />\r\n            </IconButton>\r\n            <IconButton>\r\n              {playOrPauseButton}\r\n            </IconButton>\r\n            <IconButton>\r\n              <Next onClick={this.playNextHandle} />\r\n            </IconButton>\r\n          </div>\r\n        </div>\r\n           \r\n        {/* 加上crossOrigin=\"anonymous\" */}\r\n        <audio id=\"audio-element\"\r\n          ref = \"audioElement\"\r\n          src={`/song/media/outer/url?id=${currentId}.mp3`}\r\n          crossOrigin=\"anonymous\"\r\n          autoPlay={this.props.isPlaying}\r\n          >\r\n        </audio>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToprops = (state) => ({\r\n  currentSong: state.song.currentSong,\r\n  isPlaying: state.song.isPlaying,\r\n  playlist: state.song.playlist\r\n})\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  toggleIsPlaying: () => dispatch(toggleIsPlaying()),\r\n  toCurrentSongPlay: (song) => dispatch(toCurrentSongPlay(song))\r\n})\r\n\r\nexport default connect(mapStateToprops, mapDispatchToProps)(Controllerbar);\r\n","import React, { Component } from 'react';\r\nimport Headbar from './container/Headbar/';\r\nimport Playlist from './container/Playlist/';\r\nimport Playmain from './container/Playmain/';\r\nimport Spectrum from './container/Spectrum/';\r\nimport Controllerbar from './container/Controllerbar/';\r\n\r\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\r\nimport darkBaseTheme from 'material-ui/styles/baseThemes/darkBaseTheme';\r\nimport getMuiTheme from 'material-ui/styles/getMuiTheme';\r\nimport lightBaseTheme from 'material-ui/styles/colors';\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {theme: darkBaseTheme}\r\n  }\r\n  changeMuiTheme(num) {\r\n    this.setState({theme :num === 1 ? lightBaseTheme : darkBaseTheme })\r\n  } \r\n  render() {\r\n    return (\r\n      <MuiThemeProvider muiTheme={getMuiTheme(this.state.theme)}>\r\n          <div className=\"app\">\r\n              <Headbar onChangeTheme={(num)=>this.changeMuiTheme(num)}></Headbar>\r\n              <div className=\"l-m-s-c-wrapper\">\r\n                  <div className=\"list-main-wrapper\">\r\n                    <Playlist></Playlist>\r\n                    <Playmain></Playmain>\r\n                  </div>\r\n                \r\n                  <Controllerbar></Controllerbar> \r\n                  <Spectrum></Spectrum>\r\n              </div>\r\n          </div>\r\n      </MuiThemeProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import { combineReducers } from 'redux';\r\nimport user from './user';\r\nimport song from './song';\r\n\r\nexport default combineReducers({ user, song });\r\n","import { createStore, applyMiddleware, compose } from 'redux';\r\nimport reducer from './reducer/';\r\nimport thunk from 'redux-thunk';\r\n\r\n\r\nconst win = window;\r\n\r\nconst middlewares = [];\r\nif (process.env.NODE_ENV !== 'production') {\r\n  middlewares.push(thunk);\r\n}\r\n\r\nconst storeEnhancers = compose(\r\n  applyMiddleware(...middlewares),\r\n  (win && win.devToolsExtension) ? win.devToolsExtension() : (f) => f\r\n);\r\n\r\n\r\nexport default createStore(reducer, storeEnhancers); \r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport App from './App';\r\nimport store from './store.js';\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}